Examples
========

.. note::

    The :ref:`ffmpeg-sender` and :ref:`ffplay-receiver` examples both make
    use of UNIX pipes and will only work on supported operating systems.



.. _ffmpeg-sender:

Sender
------

Frames are generated by `ffmpeg`_ running in a subprocess which outputs the raw
data to its :attr:`~subprocess.Popen.stdout`.

A :class:`~cyndilib.sender.Sender` is created and an instance of
:class:`~cyndilib.video_frame.VideoSendFrame` is added to it.

The raw data from ffmpeg is then fed using the Sender's
:meth:`~cyndilib.sender.Sender.write_video_async` method.


.. literalinclude:: ../../examples/ffmpeg_sender.py
    :language: python
    :linenos:
    :name: ffmpeg_sender



.. _ffplay-receiver:

Receiver
--------

This example receives video frames from an |NDI| :class:`~cyndilib.finder.Source`
and shows them using `ffplay`_.

:class:`~cyndilib.finder.Finder` is used to locate the :class:`~cyndilib.finder.Source`
with the given name.

A :class:`~cyndlib.receiver.Receiver` then created and an instance of
:class:`~cyndilib.video_frame.VideoFrameSync` is added to it.

Video frames are then read using the
:meth:`FrameSync.capture_video <cyndilib.framesync.FrameSync.capture_video>`
method which is available from the :attr:`~cyndilib.receiver.frame_sync` attribute
on the receiver.

The data is then fed to the :attr:`~subprocess.Popen.stdin` of the ``fplay``
subprocess directly from the video frame using the
:ref:`buffer protocol <frame-buffer-protocol>`.


.. literalinclude:: ../../examples/ffplay_receiver.py
    :language: python
    :linenos:
    :name: ffplay_receiver




.. _ffmpeg: https://ffmpeg.org
.. _ffplay: https://ffmpeg.org/ffplay.html
